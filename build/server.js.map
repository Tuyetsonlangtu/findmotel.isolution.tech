{"version":3,"file":"../../server.js","sources":["webpack:///webpack/bootstrap 4dee3d1dd4330b391b6a","webpack:///external \"express\"","webpack:///./src/models/index.js","webpack:///./src/common/config.js","webpack:///./src/models/user.js","webpack:///external \"passport\"","webpack:///external \"path\"","webpack:///./src/server/server.js","webpack:///external \"babel-polyfill\"","webpack:///./src/server/passport/auth.facebook.js","webpack:///./src/server/passport/config.js","webpack:///./src/server/routes/api/index.js","webpack:///./src/server/routes/api/user.route.js","webpack:///./src/server/routes/index.js","webpack:///external \"body-parser\"","webpack:///external \"cookie-parser\"","webpack:///external \"mongoose\"","webpack:///external \"passport-facebook\"","webpack:///external \"randomstring\""],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/assets/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 20);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4dee3d1dd4330b391b6a","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","/**\r\n * Created by hien.tran on 6/2/2017.\r\n */\r\n\r\n\"use strict\";\r\nimport mongoose from 'mongoose';\r\nimport config from '../common/config';\r\nimport user from './user';\r\n\r\n//Config mongodb\r\nlet conn = mongoose.createConnection(config.database.mongoose.databaseURI)\r\nlet Schema = mongoose.Schema;\r\nmongoose.Promise = Promise;\r\nmongoose.set('debug', config.database.mongoose.logging);\r\n\r\n\r\nconst User = conn.model(user.name, user.schema);\r\n\r\nexport { User}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/models/index.js\n// module id = 1\n// module chunks = 0","\nif (process.env.BROWSER) {\n  throw new Error('Do not import `config.js` from inside the client-side code.');\n}\n\nconst port = 4000;\nmodule.exports = {\n  // Node.js app\n  port: process.env.PORT || port,\n\n  // API Gateway\n  api: {\n    // API URL to be used in the client-side code\n    clientUrl: process.env.API_CLIENT_URL || '',\n    // API URL to be used in the server-side code\n    serverUrl: process.env.API_SERVER_URL || `http://localhost:${process.env.PORT || port}`,\n  },\n\n  analytics: {\n    googleTrackingId: process.env.GOOGLE_TRACKING_ID, // UA-XXXXX-X\n  },\n\n  database: {\n    mongoose: {\n      databaseURI : \"mongodb://10.0.15.5:27017/ISolution-FindMotel\",\n      logging: false\n    }\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/common/config.js\n// module id = 2\n// module chunks = 0","/**\r\n * Created by hien.tran on 6/2/2017.\r\n */\r\n\r\n\"use strict\";\r\nimport randomString from 'randomstring';\r\nimport mongoose from 'mongoose';\r\nlet Schema = mongoose.Schema;\r\n\r\nfunction metSalt(){\r\n  return randomString.generate({length: 50});\r\n}\r\nfunction metSetId() {\r\n  return randomString.generate(12);\r\n}\r\n\r\nconst User = new Schema({\r\n  _id: {\r\n    type: String,\r\n    default: metSetId,\r\n    index: true,\r\n    unique: true\r\n  },\r\n  username:{\r\n    type: String,\r\n    unique: true,\r\n  },\r\n  password:{\r\n    type: String,\r\n    unique: true,\r\n  },\r\n  salt: {\r\n    type: String,\r\n    default: metSalt\r\n  },\r\n  fullname: {\r\n    type: String,\r\n    unique: true,\r\n    sparse: true,\r\n    dropDups: true\r\n  },\r\n  email: {\r\n    type: String,\r\n    unique: true,\r\n    sparse: true,\r\n    dropDups: true\r\n  },\r\n  phone: String,\r\n  isAdmin: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  accessToken: String,\r\n  expirationDate: Date,\r\n  isEnabled: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  createdAt: {\r\n    type: Date\r\n  },\r\n  updatedAt: {\r\n    type: Date,\r\n    default: Date.now\r\n  }\r\n});\r\n\r\nexport default {\r\n  name: 'User',\r\n  schema: User\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/models/user.js\n// module id = 3\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 5\n// module chunks = 0","/**\r\n * Created by hien.tran on 5/29/2017.\r\n */\r\n\r\n\"use strict\";\r\nimport path from 'path';\r\nimport express from 'express';\r\nimport cookieParser from 'cookie-parser';\r\nimport bodyParser from 'body-parser';\r\nimport config from '../common/config';\r\nimport passport from 'passport';\r\nimport publicApi from './routes';\r\nimport privateApi from './routes/api';\r\n\r\nlet app = express();\r\n\r\napp.use(express.static(path.join(__dirname, 'public')));\r\napp.use(cookieParser());\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use(bodyParser.json());\r\n\r\napp.use(\"/\", publicApi);\r\napp.use(passport.initialize());\r\napp.use(\"/api\", privateApi);\r\n\r\napp.listen(config.port, () => {\r\n  console.info(`The server is running at http://localhost:${config.port}/`);\r\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/server/server.js\n// module id = 6\n// module chunks = 0","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 7\n// module chunks = 0","/**\r\n * Created by hien.tran on 6/2/2017.\r\n */\r\n\r\nimport passport from 'passport';\r\nimport { Strategy as FacebookStrategy } from 'passport-facebook';\r\nimport config from './config';\r\nimport {User} from '../../models';\r\n\r\npassport.use(new FacebookStrategy({\r\n  clientID: config.auth.facebook.clientID,\r\n  clientSecret: config.auth.facebook.clientSecret,\r\n  callbackURL: config.auth.facebook.callbackURL,\r\n  profileFields: ['displayName', 'name', 'email', 'link', 'locale', 'timezone'],\r\n  passReqToCallback: true,\r\n}, (req, accessToken, refreshToken, profile, done) => {\r\n\r\n  const result = async () => {\r\n\r\n  }\r\n  result().catch(done);\r\n\r\n  User.findOne({'email': 'duchienntu@gmail.com'}).then( obj => {\r\n    console.log(\"obj: \", obj);\r\n  });\r\n\r\n  console.log(\"accessToken: \", accessToken);\r\n  const loginName = 'facebook';\r\n  const claimType = 'urn:facebook:access_token';\r\n  done(null, { id: '123', email: 'duchienntu@gmail.com',});\r\n}));\r\n\r\nexport default passport;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/server/passport/auth.facebook.js\n// module id = 9\n// module chunks = 0","/**\r\n * Created by hien.tran on 6/2/2017.\r\n */\r\n\r\n\r\nmodule.exports = {\r\n  // Authentication\r\n  auth: {\r\n    jwt: { secret: process.env.JWT_SECRET || 'React Starter Kit' },\r\n    facebook: {\r\n      clientID: process.env.FACEBOOK_APP_ID || '2006619856232997',\r\n      clientSecret: process.env.FACEBOOK_APP_SECRET || '2466ea45b5f5d3d1b2227758c08f0922',\r\n      callbackURL: '/auth/facebook/callback'\r\n    },\r\n\r\n    google: {\r\n      id: process.env.GOOGLE_CLIENT_ID || '251410730550-ahcg0ou5mgfhl8hlui1urru7jn5s12km.apps.googleusercontent.com',\r\n      secret: process.env.GOOGLE_CLIENT_SECRET || 'Y8yR9yZAhm9jQ8FKAL8QIEcd',\r\n    },\r\n\r\n    twitter: {\r\n      key: process.env.TWITTER_CONSUMER_KEY || 'Ie20AZvLJI2lQD5Dsgxgjauns',\r\n      secret: process.env.TWITTER_CONSUMER_SECRET || 'KTZ6cxoKnEakQCeSpZlaUCJWGAlTEBJj0y2EMkUBujA7zWSvaQ',\r\n    },\r\n  },\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/server/passport/config.js\n// module id = 10\n// module chunks = 0","/**\r\n * Created by hien.tran on 6/2/2017.\r\n */\r\n\r\n\"use strict\";\r\nmodule.exports = (app) => {\r\n  let express = require('express')\r\n    ,router = express.Router();\r\n\r\n  router.use(\"/user\", require(\"./user.route\")(app));\r\n  return router;\r\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/server/routes/api/index.js\n// module id = 11\n// module chunks = 0","/**\r\n * Created by hien.tran on 6/2/2017.\r\n */\r\n\r\n\"use strict\";\r\nimport express from 'express';\r\nlet router = express.Router();\r\n\r\nrouter.get('/', (req, res) => {\r\n  res.json({ status: \"user info\" });\r\n});\r\n\r\nexport default router;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/server/routes/api/user.route.js\n// module id = 12\n// module chunks = 0","/**\r\n * Created by hien.tran on 6/2/2017.\r\n */\r\n\r\n\"use strict\";\r\n\r\nimport express from 'express';\r\nimport fbPassport from '../passport/auth.facebook';\r\nlet router = express.Router();\r\n\r\nrouter.get('/', (req, res) => {\r\n  res.json({status: \"server runing\"});\r\n});\r\n\r\nrouter.post('/user', (req, res) => {\r\n  res.json({status: \"create user\"});\r\n});\r\n\r\nrouter.get('/auth/facebook',\r\n  fbPassport.authenticate('facebook', { scope: ['email', 'user_location'], session: false })\r\n);\r\n\r\nrouter.get('/auth/facebook/callback', (req, res, next) => {\r\n  fbPassport.authenticate('facebook', (err) => {\r\n    let rs = {\r\n      success: err,\r\n      message: \"login success\"\r\n    }\r\n    if(err) rs = { success: err, message: 'login fail' }\r\n    return res.json(rs);\r\n  })(req, res, next);\r\n});\r\n\r\nexport default router;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/server/routes/index.js\n// module id = 13\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"passport-facebook\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-facebook\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"randomstring\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"randomstring\"\n// module id = 19\n// module chunks = 0"],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;A;;;;AChEA;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC5BA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACtEA;;;;;;ACAA;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AC3BA;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACXA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACZA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACjCA;;;;;;ACAA;;;;;;;ACAA;;;;;;ACAA;;;;;;ACAA;;;;;;;;;;;A","sourceRoot":""}